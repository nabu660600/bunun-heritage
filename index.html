<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>布農之蹤 | Bunun Heritage Interactive Map</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* 定義網頁全域變數：方便統一管理顏色，提升代碼可讀性 */
        :root { 
            --bunun-red: #A52A2A;   /* 象徵布農族傳統的赭紅色 */
            --bunun-dark: #121212;  /* 深黑背景，減少眼睛負擔並增加莊嚴感 */
            --bunun-gold: #C5A059;  /* 象徵榮耀的金色，用於重點標題 */
        }

        /* 設定網頁背景顏色與預設字型 */
        body { 
            background-color: var(--bunun-dark); 
            color: white; 
            font-family: 'Noto Serif TC', serif; 
        }

        /* 地圖容器設定：使用 vh (視窗高度單位) 確保地圖在大螢幕上也很清晰 */
        #map { 
            height: 75vh; 
            width: 100%; 
            border: 2px solid var(--bunun-red); 
            border-radius: 10px; 
        }

        /* 歷史事件卡片樣式：設定左右側的佈局與陰影效果 */
        .event-card { 
            background: #1e1e1e; 
            border-left: 5px solid var(--bunun-red); 
            margin-bottom: 15px; 
            padding: 10px; 
            cursor: pointer; 
            border-radius: 8px; 
            transition: 0.3s; /* 滑鼠移入時的平滑過渡效果 */
        }

        /* 滑鼠移入卡片時：變換邊框顏色並產生輕微浮動感 */
        .event-card:hover { 
            background: #252525; 
            border-left-color: var(--bunun-gold); 
        }

        /* 設定卡片內圖片大小：object-fit: cover 確保不同尺寸的圖片都能填滿且不變形 */
        .event-card img { 
            width: 100%; 
            height: 150px; 
            object-fit: cover; 
            border-radius: 5px; 
        }

        .hero { text-align: center; padding: 30px; }
    </style>
</head>
<body>

    <div class="hero">
        <h1>布農足跡：高山遷徙史</h1>
        <p style="color:var(--bunun-gold)">探索布農族橫跨中央山脈的壯烈史詩</p>
    </div>

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-8">
                <div id="map"></div>
            </div>
            <div class="col-md-4" style="height:75vh; overflow-y:auto;" id="list">
                </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // 1. 初始化地圖：設定中心點為台灣山區 [23.7, 121.0]，縮放層級 8
        const map = L.map('map').setView([23.7, 121.0], 8);

        // 2. 載入底圖：使用 CartoDB 的深色底圖，強調歷史沉重與莊嚴感
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

        // 3. 資料結構：使用陣列(Array)儲存多筆歷史事件，方便維護與擴充
        const events = [
            { t: "神話起點", l: [23.47, 120.95], i: "https://insight.ipcf.org.tw/s/Item/Content/4cadbebece3d4e80968bbf7d0e0093fe.jpg", s: "傳說中族人逃往玉山避難。" },
            { t: "南遷東移", l: [23.3, 121.0], i: "https://www.ysnp.gov.tw/FileDownload/ContentManagement/20210809161046271205070.jpg", s: "翻越中央山脈進入花蓮卓溪、台東海端。" },
            { t: "獵場之戰", l: [23.5, 120.8], i: "https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/A_Man_Surnamed_Mao_from_the_Thao_Tribe_by_the_Sun_Moon_Lake.jpg/250px-A_Man_Surnamed_Mao_from_the_Thao_Tribe_by_the_Sun_Moon_Lake.jpg", s: "與鄒族發生激烈的獵場爭奪。" },
            { t: "大分事件", l: [23.44, 121.15], i: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR3ZyevzRd-2jgPTrKAmSM1_ZwUyX4NYfVdQA&s", s: "拉馬達·仙仙發動的抗日事件。" },
            { t: "族群衝突", l: [24.02, 121.13], i: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3nv47ykSLTfpWBy_pWOYTKHpcf9KWUcBqH8nw9CRkUc9w7xQzMT6qjs37vwxs5kteQs4Q3x-udI5DeiT-dzKyFgl4AX0bSvCwG5g6XKsWA2WKdNRknFs2A9FhC6mrn1tU8G1RTw/s1600/lona.jpg", s: "日治時期被誘導的族群矛盾。" },
            { t: "內本鹿事件", l: [22.95, 121.01], i: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTSXZsdzkxGYJZVVd8glq3RClCih4YvY36feQ&s", s: "台東內本鹿族人的最後抗爭。" }
        ];

        // 4. 取得 HTML 中的列表容器
        const listContainer = document.getElementById('list');

        // 5. 邏輯處理：迴圈跑每一筆事件資料，生成地標與卡片
        events.forEach(event => {
            // A. 在地圖上放置地標 (Marker) 並綁定彈出視窗 (Popup)
            const marker = L.marker(event.l).addTo(map)
                .bindPopup(`<b>${event.t}</b><br><img src="${event.i}" width="100%">`);

            // B. 動態建立 HTML 元素作為右側卡片
            const card = document.createElement('div');
            card.className = 'event-card';
            card.innerHTML = `
                <img src="${event.i}">
                <h6 class="mt-2 text-warning">${event.t}</h6>
                <p class="small text-secondary mb-0">${event.s}</p>
            `;

            // C. 互動連動：點擊卡片時，地圖會飛到座標點位並自動打開彈窗
            card.onclick = () => {
                map.flyTo(event.l, 11); // 使用平滑飛行效果 (flyTo) 增加動態感
                marker.openPopup();    // 自動開啟對應的地圖彈窗
            };

            // D. 將產生的卡片放進列表容器中
            listContainer.appendChild(card);
        });
    </script>
</body>
</html>
